---
title:  "Rubyé¢è©¦ç²¾é¸30é¡Œ - Day16 iterator å’Œ loop æ¯”è¼ƒ"
preview: "Ruby interview question: What's Iterator? How many iterators are there in Ruby?"
permalink: "/articles/2018-09-30-day16_ruby_interview_questions_iterator"
date:   2018-09-30 08:29:00
layout: post
tags: 
  - "interview"
comments: true
---

è©±èªªå·¥ç¨‹å¸«å€‘æ˜¯ä¸€ç¾¤å‰µæ–°åˆå·æ‡¶çš„äººï¼Œèƒ½å¤ åªå¯«ä¸€è¡Œç¨‹å¼ç¢¼ï¼Œå°±ä¸ç”¨å¯«å…©è¡Œã€‚è¿­ä»£å™¨å°±æ˜¯ä¸€å€‹èƒ½å¹«åŠ©æˆ‘å€‘é”æˆé€™å€‹ç›®æ¨™çš„å¥½æ±è¥¿ï¼Œèƒ½æŠŠåšé‡è¤‡çš„äº‹æƒ…çš„æƒ…æ³æ¸›å°‘åˆ°æœ€ä½ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥çœä¸‹æ›´å¤šæ™‚é–“å»äº«å—äººç”Ÿå•¦ï½
<!-- more -->

---

é‡é»æ‘˜è¦:
* abstact
{:toc}

---

# Rubyç¶“å…¸é¢è©¦é¡Œç›® #16

* ä»€éº¼æ˜¯è¿­ä»£å™¨? è«‹è§£é‡‹Rubyè£¡é¢æœ‰å“ªå¹¾ç¨®è¿­ä»£å™¨?  
What's `Iterator`? How many iterators are there in Ruby?`

# Iterator

è¿­ä»£å™¨ (iterator) å°±æ˜¯ç”¨ä¾†é‡è¤‡å¤šæ¬¡ç›¸åŒçš„äº‹ã€‚(Do one thing many times like a loop.)é‚„è¨˜å¾—æˆ‘å€‘åœ¨å‰å¤©çš„æ™‚å€™æåˆ°`.each`, `.map`å’Œ`.collect`æ™‚å€™ï¼Œæœ‰æåˆ°è¿­ä»£å™¨çš„æ¦‚å¿µã€‚ä»Šå¤©è¦ä¾†æ¥è§¸æ›´å¤šçš„è¿­ä»£å™¨ï¼Œåœ¨æ–‡ç« å¾ŒåŠéƒ¨æœƒæåˆ°ç›¸ä¼¼çš„è¿´åœˆï¼

é¦–å…ˆå¾`.each`é–‹å§‹è¤‡ç¿’ï¼š

```ruby
(collection).each do |variable|
 #åšä¸€äº›é‡è¤‡çš„äº‹#
end
```

ç¯„ä¾‹:

```ruby
(1...4).each do |i|
   puts "éµäººè³½ç¬¬16å¤©äº†!!"
end
```

çµæœ:

```ruby
éµäººè³½ç¬¬16å¤©äº†!!
éµäººè³½ç¬¬16å¤©äº†!!
éµäººè³½ç¬¬16å¤©äº†!!
```

é€™é‚Šçš„`(1...4)`æ˜¯`Rangeï¼ˆç¯„åœï¼‰`çš„å¯«æ³•ã€‚

`(...)`ä¸­é–“æœ‰ä¸‰å€‹é»ï¼Œä»£è¡¨ä¸åŒ…å«æœ€å¾Œä¸€å€‹æ•¸å­—4ã€‚ï¼ˆå¾1åˆ°3è€Œå·²ï¼Œæ‰€ä»¥åªå°äº†3æ¬¡ï¼‰ï¼›

å¦‚æœæ˜¯åªæœ‰å…©é»çš„è©±`(..)`ï¼Œåƒé€™æ¨£å­`(1..4`)å°±æœƒå°4æ¬¡å–”ã€‚

## String: å­—ä¸²è¿­ä»£å™¨: each_line iterator

Each_lineå’Œeachçš„æ–¹æ³•é¡ä¼¼ï¼Œéƒ½å¯ä»¥åˆ©ç”¨`do...end`æˆ–æ˜¯`{}`å¤§æ‹¬å¼§çš„èªæ³•ï¼Œåœ¨`block`å€å¡Šå…§å¯«ä¸‹æˆ‘å€‘æƒ³è¦ç¨‹å¼å¹«å¿™é‡è¤‡åŸ·è¡Œçš„åŠŸèƒ½ã€‚`each_line`å¯ä»¥åµæ¸¬åˆ°ç©ºè¡Œ`\n`æ®µè½ï¼Œå°å‡ºç©ºè¡Œï¼š

```ruby
"[æˆç‚ºå·¥ç¨‹å¸«]\nå°ˆå¿ƒï¼\nå …æŒï¼\nä¸€å®šå¯ä»¥\næˆåŠŸçš„å–”ï¼".each_line do |line|
  puts line
end
```

çµæœï¼š

```ruby
tingdeMacBook-Air:Ironman tingtinghsu$ ruby iterator.rb
[æˆç‚ºå·¥ç¨‹å¸«]
å°ˆå¿ƒï¼
å …æŒï¼
ä¸€å®šå¯ä»¥
æˆåŠŸçš„å–”ï¼
```

## Character: å­—å…ƒè¿­ä»£å™¨: each_byte iterator

é™¤äº†å­—ä¸²è¿­ä»£ï¼Œå­—å…ƒä¹Ÿå¯ä»¥è¿­ä»£ï¼`.each_byte`å¯ä»¥å¹«æˆ‘å€‘è¼•é¬†é”åˆ°é€™å€‹åŠŸèƒ½ï¼Œ

```ruby
"You can achieve anything you want to".each_byte { #blockæŠŠdo end æ›æˆå¤§æ‹¬å¼§ä¹Ÿå¯ä»¥
  |c| printf "%c ", c
}
```

`printf`ä½¿ç”¨æ ¼å¼åŒ–çš„å­—å…ƒ`%c`è¼¸å‡ºå­—ä¸²ï¼Œå°±å’Œcèªè¨€ä¸€æ¨£ï¼›è€Œ`print`èˆ‡`puts`çš„å·®åˆ¥åœ¨æ–¼`print`ä¸æœƒå¹«æˆ‘å€‘è‡ªå‹•æ›è¡Œï¼Œ[åƒè€ƒé€™è£¡](http://maku77.github.io/ruby/io/print-to-stdout.html)ã€‚ï¼ˆé€™å¤§æ¦‚æ˜¯ç‚ºä»€éº¼`puts`æ¯”è¼ƒå¸¸è¦‹å§ï¼æœ‰æ²’æœ‰æ›è¡Œçš„è¦–è¦ºæ•ˆæœå·®å¾ˆå¤šï½ï¼‰

```ruby
tingdeMacBook-Air:Ironman tingtinghsu$ ruby iterator.rb
[æˆç‚ºå·¥ç¨‹å¸«]
å°ˆå¿ƒï¼
å …æŒï¼
ä¸€å®šå¯ä»¥
æˆåŠŸçš„å–”ï¼
Y o u   c a n   a c h i e v e   a n y t h i n g   y o u   w a n t   t o tingdeMacBook-Air:Ironman tingtinghsu$
```

ä¿¡å¿ƒå–Šè©±å®Œæˆï¼

æ¥ä¸‹ä¾†æˆ‘å€‘è¦ä»‹ç´¹å„ç¨®è¿­ä»£å™¨é‹ç”¨åœ¨æ•¸å€¼è®Šæ•¸çš„æƒ…å½¢ã€‚ç‚ºäº†ç´€å¿µéµäººè³½ç¬¬16å¤©ï¼ˆé€²åº¦æ¢è¶…éä¸€åŠäº†ï¼ï¼‰æˆ‘æ‰“ç®—åˆ©ç”¨å„ç¨®è¿­ä»£å™¨å°å‡ºå¾1åˆ°16çš„å¶æ•¸ï¼Œä¸¦åœ¨æ–‡ç« çš„æœ€å¾Œèˆ‡loopè¿´åœˆåšæ¯”è¼ƒï¼š

## each iterator

```ruby
(1..16).each do |i|
 if (i%2 == 0)
  puts i
 end
end #å°å‡º1-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

## time iterator

```ruby
16.times do |i|
 if (i%2 == 0)
  puts i
 end
end
# #å°å‡º0-15ä¹‹é–“çš„å¶æ•¸ 0 2 4 6 8 10 12 14
```

ä½¿ç”¨`.time`æ–¹æ³•ï¼Œ`i`æœƒå¾`0`é–‹å§‹è·‘è¿­ä»£ã€‚

å°æ‹¬è™Ÿä»£è¡¨çš„ç¯„åœ`(..)`åˆå‡ºç¾äº†ï¼é‚„è¨˜å¾—æ‹¬å¼§å…§å¦‚æœä»¥å…©é»`..`è¡¨ç¤ºï¼ŒæœƒåŒ…å«é ­èˆ‡å°¾çš„æ•¸å€¼å—?

## upto iterator

```ruby
1.upto(16) do |i|
  if (i%2==0)
  puts i
  end
end #å°å‡º1-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

## downto iterator

é™¤äº†å¾€ä¸Šæ•¸`.upto`ï¼Œiteratorä¹Ÿæœ‰å¾€ä¸‹æ•¸`.downto`çš„æ–¹æ³•ï¼š

```ruby
16.downto(1) do |i|
  if (i%2==0)
  puts i
  end
end  #å°å‡º16-1ä¹‹é–“çš„å¶æ•¸ 16 14 12 10 8 6 4 2
```

## step iterator

`.step` iteratorå°±åƒçˆ¬æ¨“æ¢¯ä¸€æ¨£ï¼Œä¸€æ¬¡çˆ¬å…©æ ¼æ¨“æ¢¯è©¦è©¦çœ‹ï¼š

```ruby
2.step(16, 2) do |i|
  puts i
end #å°å‡º2-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

æ¨“æ¢¯å¯ä»¥å¾€ä¸Šçˆ¬ä¹Ÿå¯ä»¥å¾€ä¸‹èµ°:

```ruby
2.step(16, 2) do |i|
  puts i
end #å°å‡º16-2ä¹‹é–“çš„å¶æ•¸ 16 14 12 10 8 6 4 2
```

# Loop

åœ¨æŒ‘æˆ°ä»Šå¤©çš„éµäººè³½çš„æ™‚å€™ï¼Œæˆ‘ç™¼ç¾`Loop`å’Œ`Iterator`åŸºæœ¬ä¸Šéƒ½æœ‰é¡ä¼¼çš„åŠŸèƒ½ï¼š`é‡è¤‡åšç›¸åŒçš„äº‹`ã€‚ä¾†ä»‹ç´¹è¿´åœˆ`loop`ï¼š`for`è¿´åœˆï¼Œ `while`ï¼Œä»¥åŠWhileçš„å­¿ç”Ÿå…„å¼Ÿ`until`å§ï¼

## ç›´æ¥æŠŠLoopé—œéµå­—åŠ åœ¨blockä¹‹å‰

å¦‚æœè¦é”æˆå’Œè¿­ä»£å™¨ï¼ŒåŒæ¨£çš„åŠŸèƒ½(å°å‡º1åˆ°16ä¹‹é–“çš„å¶æ•¸)ï¼ŒLoopè©²å¦‚ä½•é€²è¡Œå‘¢?

```ruby
i=1 #è¨˜å¾—è¨­å®šåˆå§‹å€¼!
puts(loop do
  if (i%2==0)
    puts "#{i}"
  end
  i+=1
  break if i>16 #è¨˜å¾—åŠ ä¸Šçµ‚æ­¢æ¢ä»¶
end) #å°å‡º2-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

å…‰æ˜¯çœ‹åˆ°é€™æ¨£è½è½é•·çš„å¯«æ³•å°±è¦ºå¾—å¾ˆä¸ç¾è§€ï¼Œæ›æˆwhileè©¦è©¦:

## while loop

```ruby
i =1 #è¨˜å¾—è¨­å®šåˆå§‹å€¼
while (i <= 16) do
  if (i%2 == 0)
    puts i
  end
  i +=1
end  #å°å‡º2-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

## until loop  

`until`å‰‡å‰›å¥½æ˜¯`while`çš„ç›¸åï¼Œæ„æ€æ˜¯é™¤éæ¢ä»¶ä¸ç¬¦åˆï¼Œå¦å‰‡é€²è¡Œè¿´åœˆ:

```ruby
i =1 #è¨˜å¾—è¨­å®šåˆå§‹å€¼
until i > 16
  if (i%2 == 0)
    puts i
  end  
  i += 1
end
```

é‚£ï¼ŒLoopè¿´åœˆå’ŒIteratorè¿­ä»£å™¨ï¼Œåˆ°åº•å·®åœ¨å“ªè£¡ï¼Œä¸”å­°å„ªå­°åŠ£å‘¢?

å¦‚æœåªæ˜¯è·‘å–®ç´”çš„Loopè©±ï¼ˆä¾‹å¦‚å¾1åŠ åˆ°1ç™¾è¬ï¼‰ï¼ŒLoopé€Ÿåº¦æœƒæ¯”Iteratorå¿«å¾ˆå¤šã€‚[åƒè€ƒBaterçš„æ–‡ç« ](https://blog.bater.gq/ruby/2017/11/26/ruby-Iterator-and-which-one-is-faster.html)

è€Œ[å¾Codecademyé€™ç¯‡æ–‡ç« ](https://www.codecademy.com/en/forum_questions/5294ba4480ff338cc9002444)å¯ä»¥äº†è§£ï¼ŒLoopä¸€å®šè¦åŒ…å«çµ‚æ­¢æ¢ä»¶ã€‚å¦‚æœä½ ä¸èƒ½ç¢ºå®šè¿´åœˆçš„çµ‚æ­¢æ¢ä»¶ï¼ˆå¿…é ˆç‚º`true`ï¼‰å°±åŸ·è¡Œè¿´åœˆï¼Œé‚£ç„¡çª®è¿´åœˆï¼ˆé¬¼æ‰“ç‰†ï¼‰çš„æƒ…å½¢å°±æœ‰å¯èƒ½ç™¼ç”Ÿã€‚

èˆ‰å€‹ä¾‹å­ğŸŒ°ä¾†èªªï¼Œæˆ‘åœ¨æ”¹while loopç¨‹å¼ç¢¼ä»¥ç¬¦åˆæˆ‘çš„é‚è¼¯ï¼ˆå°å‡º1-16ä¹‹é–“çš„å¶æ•¸ï¼‰æ™‚ï¼Œä¸å°å¿ƒæŠŠ`i+=1`æ”¾é€²`ifæ¢ä»¶åˆ¤æ–·å¼`è£¡ï¼Œçµæœç¨‹å¼ç¢¼æ•´å€‹ç•¶æ‰ï¼ˆå› ç‚ºiåˆ°æœ€å¾Œä¸€æ¬¡åŸ·è¡Œ+1å®Œå°±å¤§æ–¼16äº†ï¼‰

```ruby
i =1 #è¨˜å¾—è¨­å®šåˆå§‹å€¼
while (i <= 16) do
  if (i%2 == 0)
    puts i
    i +=1 #é€™è¡Œæ”¾éŒ¯åœ°æ–¹äº†!
  end
  #i +=1  æ‡‰è©²è¦æ”¾åœ¨if...endå¤–æ‰å°!
end
```

å› æ­¤ï¼Œè¨˜å¾—åœ¨whileçš„è¿´åœˆä¹‹å‰ï¼Œå¿…é ˆè¨­å®š`i=1`åˆå§‹å€¼ï¼Œä¸”å¼·åˆ¶è®“æ¯æ¬¡è·‘å®Œè¿´åœˆæ™‚ï¼Œièƒ½å¤ éå¢`i+=1`ã€‚

## for loop

å¦‚æœæˆ‘å€‘ä¸è¦æ¯æ¬¡éƒ½è¨­å®š`i=1`å’Œ`i+=1`ï¼ˆå¥½ç…©å•Šè€Œä¸”ä½ç½®å®¹æ˜“æ“ºéŒ¯ã€ç¨‹å¼å°±ç•¶æ‰ XDï¼‰ï¼Œå¯ä»¥åˆ©ç”¨`for...end`è¿´åœˆï¼Œèˆ‡æ–‡ç« é–‹é ­æåˆ°çš„`Range(..)`(ç¯„åœ)çš„çµåˆï¼š

```ruby
for i in 1..16 # (1..16)ç¯„åœçš„å°æ‹¬è™Ÿå¯çœç•¥
 if (i%2 == 0) #åŠ å…¥å¶æ•¸çš„æ¢ä»¶åˆ¤æ–·
  puts i
 end
end #å°å‡º1-16ä¹‹é–“çš„å¶æ•¸ 2 4 6 8 10 12 14 16
```

æœ€å¾Œï¼Œç‚ºä»€éº¼æˆ‘å€‘è¦å¤šä½¿ç”¨è¿­ä»£å™¨å‘¢?å› ç‚ºiteratorå¸¸å¸¸å’Œarrayæˆ–æ˜¯hashçµåˆï¼ŒåŠ ä¸Šè¨±å¤šå¯¦ç”¨çš„å­—ä¸²æ–¹æ³•ï¼Œå¹«æˆ‘å€‘ç”¨ç°¡å–®ã€å„ªé›…çš„å¯«æ³•å®Œæˆè¤‡é›œçš„åŠŸèƒ½ï¼š

### Iterator - `.each`å¯«æ³•

```ruby
a = [2, 4, 6, 8]
p a.each {|x| x*2} #=> [2,4,6,8]
```

### Loop - `while` ç”¨åœ¨ Arrayçš„å¯«æ³•

```ruby
a = [2, 4, 6, 8]
i = 0
while (i < a.length)
  print (a[i]*2).to_s + " "
  i += 1
end
print "\n" #=> 2 4 6 8
```

åªè¦åœ¨Arrayæˆ–Hashçš„çµæ§‹è£¡ã€å¯¦ç¾çš„åŠŸèƒ½è¶Šè¤‡é›œï¼Œiteratorå°±æ¯”loopçœä¸‹æ›´å¤šçš„ç¨‹å¼ç¢¼ï¼

å¦‚ä¸Šè¿°é¡¯ç¤ºï¼Œ`.each`æ¯”èµ·whileï¼Œåƒ…ç”¨äº†2è¡Œç¨‹å¼ç¢¼å°±å®Œæˆäº†æˆ‘å€‘éœ€è¦çš„åŠŸèƒ½ã€‚æœ‰æ²’æœ‰ç™¼ç¾è¿­ä»£å™¨çš„å¼·å¤§ä¹‹è™•å‘¢ï¼Ÿ

æ¯å¤©å¯«å®Œç¨‹å¼æ–‡ç« ï¼Œéƒ½æœƒç™¼ç¾è‡ªå·±å°é‡è¦è§€å¿µçš„å°è±¡åˆæ›´åŠ æ·±äº†ï¼æˆ–è¨±é€™å°±æ˜¯éµäººè³½çš„é­…åŠ›å§ï¼šï¼‰

Refï¼š

* [Ruby ä½¿ç”¨æ‰‹å†Š - è¿­ä»£å™¨ Iterators](https://guides.ruby.tw/ruby/iterators.html)
* [Ruby Iterator and which one is faster](https://blog.bater.gq/ruby/2017/11/26/ruby-Iterator-and-which-one-is-faster.html)
* [Loops vs iterators: I don't get the difference](https://www.codecademy.com/en/forum_questions/5294ba4480ff338cc9002444)
* [A Wealth Of Ruby Loops And Iterators](https://www.skorks.com/2009/09/a-wealth-of-ruby-loops-and-iterators/)
